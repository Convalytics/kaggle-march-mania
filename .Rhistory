######################################################
#  Kaggle March Mania Competition
#  Jason Green
#  February, 12th 2014
#  https://github.com/Convalytics/kaggle-march-mania
######################################################
#install.packages('plyr')
library(plyr)
# Set Working Directory
#setwd("C:\\Users\\jgreen\\Documents\\GitHub\\kaggle-march-mania")
setwd("~/GitHub/kaggle-march-mania")
# Import Data
regular_season_results <- read.csv("~/GitHub/kaggle-march-mania/regular_season_results.csv")
tourney_results <- read.csv("~/GitHub/kaggle-march-mania/tourney_results.csv")
sample_submission <- read.csv("~/GitHub/kaggle-march-mania/sample_submission.csv")
submission <- sample_submission
submission$lowTeam <- substr(submission$id,3,5)
submission$highTeam <- substr(submission$id,7,9)
submission$season <- substr(submission$id,1,1)
######################################################
#  Kaggle March Mania Competition
#  Jason Green
#  February, 12th 2014
#  https://github.com/Convalytics/kaggle-march-mania
######################################################
#install.packages('plyr')
library(plyr)
# Set Working Directory
#setwd("C:\\Users\\jgreen\\Documents\\GitHub\\kaggle-march-mania")
setwd("~/GitHub/kaggle-march-mania")
# Import Data
regular_season_results <- read.csv("~/GitHub/kaggle-march-mania/regular_season_results.csv")
tourney_results <- read.csv("~/GitHub/kaggle-march-mania/tourney_results.csv")
sample_submission <- read.csv("~/GitHub/kaggle-march-mania/sample_submission.csv")
submission <- sample_submission
submission$lowTeam <- substr(submission$id,3,5)
submission$highTeam <- substr(submission$id,7,9)
submission$season <- substr(submission$id,1,1)
submission
seeds <- read.csv("~/GitHub/kaggle-march-mania/tourney_seeds.csv")
slots <- read.csv("~/GitHub/kaggle-march-mania/tourney_slots.csv")
edit(seeds)
edit(slots)
edit(seeds)
names(submission)
names(seeds)
submissionWithSeeds <- merge(x = submission, y = seeds, by.x=c("lowTeam","season"), by.y=c("team","season"))
submissionWithSeeds
submission
names(submissionWithSeeds)
head(submissionWithSeeds, n=10)
nrows(submissionWithSeeds)
rename(submissionWithSeeds, "seed"="lowTeamSeed")
rename(submissionWithSeeds, seed="lowTeamSeed")
rename(submissionWithSeeds, "seed" = "lowTeamSeed")
rename(submissionWithSeeds, c("seed" = "lowTeamSeed"))
head(submissionWithSeeds, n=10)
submissionWithSeeds <- rename(submissionWithSeeds, c("seed" = "lowTeamSeed"))
head(submissionWithSeeds, n=10)
submissionWithSeeds <- merge(x = submission, y = seeds, by.x=c("highTeam","season"), by.y=c("team","season"))
submissionWithSeeds <- rename(submissionWithSeeds, c("seed" = "highTeamSeed"))
head(submissionWithSeeds, n=10)
submissionWithSeeds <- merge(x = submission, y = seeds, by.x=c("lowTeam","season"), by.y=c("team","season"))
submissionWithSeeds <- rename(submissionWithSeeds, c("seed" = "lowTeamSeed"))
submissionWithSeeds <- merge(x = submissionWithSeeds, y = seeds, by.x=c("highTeam","season"), by.y=c("team","season"))
submissionWithSeeds <- rename(submissionWithSeeds, c("seed" = "highTeamSeed"))
head(submissionWithSeeds, n=10)
regex(submissionWithSeeds$lowTeamSeed,[:digit:])
regex?
asdfa
?regex
grep(0-9,submissionWithSeeds$lowTeamSeed)
grep("[0-9]",submissionWithSeeds$lowTeamSeed)
submissionWithSeeds$lowSeed <- grep("[0-9]",submissionWithSeeds$lowTeamSeed)
head(submissionWithSeeds, n=10)
gsub("[^0-9]","",submissionWithSeeds$lowTeamSeed)
submissionWithSeeds$lowSeed <- gsub("[^0-9]","",submissionWithSeeds$lowTeamSeed)
head(submissionWithSeeds, n=10)
submissionWithSeeds$lowSeed <- gsub("[^0-9]","",submissionWithSeeds$lowTeamSeed)
submissionWithSeeds$highSeed <- gsub("[^0-9]","",submissionWithSeeds$highTeamSeed)
head(submissionWithSeeds, n=10)
head(regular_season_results, n=5)
ddply(regular_season_results,c("season", "lteam"), summarise, N=length(lteam))
Reg.Wins <- ddply(regular_season_results,c("season", "wteam"), summarise, N=length(wteam))
Reg.Losses <- ddply(regular_season_results,c("season","lteam"),summarise, N=length(lteam))
head(Reg.Wins, n=10)
submissionWithSeeds <- merge(x = submissionWithSeeds, y = Reg.Wins, by.x=c("lowTeam","season"), by.y=c("wteam","season"))
head(submissionWithSeeds, n=10)
submissionWithSeeds <- rename(submissionWithSeeds, c("N" = "lowTeamWins"))
head(submissionWithSeeds, n=10)
submissionWithSeeds <- merge(x = submissionWithSeeds, y = Reg.Losses, by.x=c("lowTeam","season"), by.y=c("lteam","season"))
submissionWithSeeds <- rename(submissionWithSeeds, c("N" = "lowTeamLosses"))
head(submissionWithSeeds, n=10)
submissionWithSeeds <- merge(x = submissionWithSeeds, y = Reg.Wins, by.x=c("highTeam","season"), by.y=c("wteam","season"))
submissionWithSeeds <- rename(submissionWithSeeds, c("N" = "highTeamWins"))
submissionWithSeeds <- merge(x = submissionWithSeeds, y = Reg.Losses, by.x=c("highTeam","season"), by.y=c("lteam","season"))
submissionWithSeeds <- rename(submissionWithSeeds, c("N" = "highTeamLosses"))
head(submissionWithSeeds, n=10)
submissionWithSeeds$lowTeamWinRate <- submissionWithSeeds$lowTeamWins/(submissionWithSeeds$lowTeamWins + submissionWithSeeds$lowTeamLosses)
head(submissionWithSeeds, n=10)
submissionWithSeeds$highTeamWinRate <- submissionWithSeeds$highTeamWins/(submissionWithSeeds$highTeamWins + submissionWithSeeds$highTeamLosses)
head(submissionWithSeeds, n=10)
sub.working <- submissionWithSeeds
head(sub.working)
sub.working$lhWinDiff <- sub.working$lowTeamWinRate - sub.working$highTeamWinRate
head(sub.working)
head(sub.working, n=20)
head(sub.working, n=5)
### Make a prediction
sub.working$prediction <- .5     # Start by assuming each team has a 50% chance of winning.
sub.working$prediction <- sub.working$prediction + sub.working$lhWinDiff     # Add the difference in win%.
head(sub.working, n=5)
sub.working$prediction[sub.working$lowSeed > sub.working$highSeed] <- sub.working$prediction + .1
sub.working$seedBonus[sub.working$lowSeed > sub.working$highSeed] <- .1
head(sub.working, n=5)
sub.working$seedBonus[sub.working$lowSeed < sub.working$highSeed] <-  -.1
head(sub.working, n=5)
sub.working$prediction <- sub.working$prediction + sub.working$seedBonus
head(sub.working, n=5)
convalytics.prediction <- c(sub.working$id, sub.working$prediction)
head(convalytics.prediction, n=10)
convalytics.prediction
convalytics.prediction <- sub.working[,c("id","prediction")]
head(convalytics.prediction, n=10)
write.csv(file=convalytics_prediction, x=convalytics.prediction)
write.csv(file=convalytics_prediction.csv, x=convalytics.prediction)
write.csv(convalytics.prediction, file = "convalytics_prediction.csv")
